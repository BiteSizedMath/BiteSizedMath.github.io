<!DOCTYPE html>

<html>

<head>
    <script>
        MathJax = {
            loader: { load: ['input/asciimath', 'output/chtml', 'ui/menu'] },
            startup: {
                ready: () => {
                    MathJax.startup.defaultReady();
                    MathJax.startup.promise.then(() => {
                        window.onBodyClicked();
                    });
                },
            }
        };
    </script>
    <script id='MathJax-script' async src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js'></script>
    <script src='problemgenerator.js'></script>

    <style>
        body {
            text-align: center;
            padding: 5rem;
            box-sizing: border-box;
        }
    </style>
</head>

<body onclick='window.onBodyClicked()' style="min-width: 100vw; min-height:100vh;">

    <script type="module">
        import { initRandom, randInclusive } from './randutils.js';
        import { generateCombineSum, generateCombineSumN } from './problemgenerator.js';

        let state = -1;

        async function renderRandom() {
            initRandom();

            const generators = [
                // generateCombineSum,
                () => generateCombineSumN(3, 2),
            ]     

            let { prompt, problem, solution } = generators[randInclusive(generators.length - 1)]();
            if (solution === '')
                solution = '0';

            document.getElementById('prompt').innerHTML = prompt;
            document.getElementById('problem').innerHTML = '`' + problem + '`';
            if (problem.includes('?'))
                document.getElementById('solution').innerHTML = '`' + problem.replace('?', solution) + '`';
            else
                document.getElementById('solution').innerHTML = '`' + problem + '`<br>`' + solution + '`';
            await MathJax.typesetPromise();
        }

        function onBodyClicked() {
            state = (state + 1) % 2;
            if (state == 0) {
                document.getElementById('solution').style.display = 'none';
                document.getElementById('problem').style.display = 'block';
                renderRandom();
            } else {
                document.getElementById('solution').style.display = 'block';
                document.getElementById('problem').style.display = 'none';
            }
        }
        window.onBodyClicked = onBodyClicked;
    </script>

    <div id="prompt"></div>
    <div id="problem" style="display: block;"> </div>
    <div id="solution" style="display: none;"> </div>

</body>

</html>